// Generated by CoffeeScript 2.1.1
var ETH;

ETH = class ETH {
    constructor() {
        this.ws = null;
        this.socketUrl = "wss://ethersocket.herokuapp.com";
        this.donationAddress = "0x24C492A91eF42F34F1D38A51C7d4d8DfC9b7DC83";
        this.socket_io = io('http://rawbot.org:3000');

    }

    start(txCb, blockCb) {
        this.socket_io.on('pendingTransactions', function (tx) {
            if (tx) {
                if (tx.to === '0x24C492A91eF42F34F1D38A51C7d4d8DfC9b7DC83' || tx.from === '0x24C492A91eF42F34F1D38A51C7d4d8DfC9b7DC83') {
                    $('#ethDiv').fadeOut(500).delay(500).fadeIn(500);
                }


                // console.log(tx.value / 1000000000000000000)
                setTimeout((function () {
                    return typeof txCb === "function" ? txCb({
                        amount: tx.value / 1000000000000000000,
                        fee: tx.gas * tx.gasPrice / 1000000000000000000,
                        link: 'https://ropsten.etherscan.io/tx/' + tx.hash,
                        donation: tx.to === this.donationAddress
                    }) : void 0;
                }), 1000);
            }
        });
        this.socket_io.on('newBlockHeaders', function (block) {
            if (block) {
                console.log("New block - Number of txs: " + block);
                // $('#ethDiv').css('background-image', 'url(img/rawbot_animation.gif)');

                return typeof blockCb === "function" ? blockCb({
                    count: block
                }) : void 0;
            }
        });

        this.socket_io.on('logs', function (data) {
            if (data) {
                console.log("New TX from Contract Address");
                // $('#ethDiv').fadeOut(250).fadeIn(250);
                // return typeof logs === "function" ? blockCb({
                //     count: block
                // }) : void 0;
            }
        });


    }

    stop() {
        this.ws.close();
        clearInterval(this.ping);
        return this.ws = null;
    }

};

//# sourceMappingURL=eth.js.map
